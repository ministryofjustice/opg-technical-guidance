<!doctype html>
<html lang="en" class="govuk-template no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>ADR-007 Healthcheck Definitions - OPG Technical Guidance</title>

    <link href="../../stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://docs.opg.service.justice.gov.uk/documentation/adrs/adr-007.html">

      <meta name="robots" content="noindex" />
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="docs.opg.service.justice.gov.uk" />
      <meta name="twitter:image" content="https://docs.opg.service.justice.gov.uk/images/govuk-large.png" />
      <meta name="twitter:title" content="ADR-007 Healthcheck Definitions - OPG Technical Guidance" />
      <meta name="twitter:url" content="https://docs.opg.service.justice.gov.uk/documentation/adrs/adr-007.html" />

      <meta property="og:image" content="https://docs.opg.service.justice.gov.uk/images/govuk-large.png" />
      <meta property="og:site_name" content="OPG Technical Guidance" />
      <meta property="og:title" content="ADR-007 Healthcheck Definitions" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://docs.opg.service.justice.gov.uk/documentation/adrs/adr-007.html" />

    
  </head>

  <body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="https://docs.opg.service.justice.gov.uk" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__product-name">
          OPG Technical Guidance
        </span>
      </a>
        <strong class="govuk-tag">internal</strong>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" aria-label="Show or hide menu">Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="../../">Home</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://github.com/ministryofjustice/opg-technical-guidance">GitHub</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1" aria-label="Table of contents" role="dialog">
              <div class="search" data-module="search" data-path-to-site-root="../../">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://docs.opg.service.justice.gov.uk"/>
    <label class="govuk-label search__label" for="search" aria-hidden="true">
      Search (via Google)
    </label>
    <input
      type="text"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                      <ul>
  <li>
    <a href="#adr-007-healthcheck-definitions"><span>ADR-007 Healthcheck Definitions</span></a>
    <ul>
      <li>
      </li>
      <li>
        <a href="#status"><span>Status</span></a>
      </li>
      <li>
        <a href="#context"><span>Context</span></a>
      </li>
      <li>
        <a href="#decision"><span>Decision</span></a>
      </li>
      <li>
        <a href="#monitoring-health-checks"><span>Monitoring Health Checks</span></a>
      </li>
      <li>
        <a href="#consequences"><span>Consequences</span></a>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content" tabindex="0">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
            <h1 id="adr-007-healthcheck-definitions">ADR-007 Healthcheck Definitions</h1>
<h3 id="date-14-02-2023">Date: 14-02-2023</h3>
<h2 id="status">Status</h2>
<p>✅ Accepted</p>
<h2 id="context">Context</h2>
<p>Across our teams there are currently slight differences in how we use the various health checks within services.</p>
<p>This is mainly in the fidelity of the checks and what they connect to. For example one service might use a health check to just check if a service&rsquo;s containers are running. Another might check that in-app connectivity is working, such as front end to internal API to DB. Another might check that the service can connect out to related services it depends on, such as Notify or other API endpoints.</p>
<p>This means that an engineer moving between products, either for temporary support or moving into a new role, could be confused at the intent of the healthcheck or make assumptions based on past experience that turn out not to be true. This is particularly true if the healthcheck is used for multiple purposes which could be at odds, for example if a healthcheck connecting to an external service was used to cause containers to scale or cycle when they didn&rsquo;t need to.</p>
<h2 id="decision">Decision</h2>
<p>We need to be clear on the purpose of each healthcheck within a service and be consistent across services in how we name, use and check them. Therefore we should categorise them as: container health checks, service health checks and dependency health checks so we are clear about what type we implement and how they are intended to be used. Urls given below are our standard suggestions, which teams should mvoe towards.</p>
<h3 id="container-health-checks">Container Health Checks</h3>
<p>These are used to determine if an individual container is running as expected. Reports that the container has finished its startup and is ready to handle requests. Should start to fail if the container needs to be cycled out.</p>
<p><code>/health-check</code></p>
<h3 id="service-health-checks">Service Health Checks</h3>
<p>These are used to determine if a service is &ldquo;up&rdquo; and working for the purposes of uptime calculation and proving that end to end within a service boundary is functioning normally. That is the front end can talk to the api and the api can talk to the DB. Typically a front end service health check will talk to the api version of the same health check.</p>
<p><code>/health-check/service</code></p>
<h3 id="dependency-health-checks">Dependency Health Checks</h3>
<p>These are used to determine if a service&rsquo;s external dependencies (external APIs like Notify or the Sirius integrations) are down and may cause service degredation. They should return details of each service status. A more developed version of this will also indicate what impact that service being down will have on the system. Teams shoudl take time to work out the likely impacts, for example Notify being down could just mean email is queued until it is working again.</p>
<p><code>/health-check/dependencies</code></p>
<h2 id="monitoring-health-checks">Monitoring Health Checks</h2>
<p>It is worth noting that for Route53 health checks AWS considers them unhealthy if they take longer than 4 seconds to connect and longer than 2 seconds to respond with a 200 or 3xx response. This means any health check connecting outside the service boundary (dependency health checks) are not recommended for these. See <a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/dns-failover-determining-health-of-endpoints.html">AWS documentation</a>.</p>
<p>Teams are encouraged to create other alerts consistent with the nature of their service to alert on broader service healthcheck failures. Some teams may want to use Pingdom, but this is not suitable for internal-only services behind an allowlist.</p>
<h2 id="consequences">Consequences</h2>

<ul>
<li>Work will need to happen to normalise the various health checks across the estate.</li>
<li>Teams will need to indentify what a dependency failure means for a given service and make that explicit with Product colleagues.</li>
<li>We will report Service Health Checks in any request for uptime stats.</li>
</ul>

              <div data-module='page-expiry' data-last-reviewed-on="2025-03-14">
    <div class='page-expiry--not-expired'>
      This page was last reviewed on 14 March 2024.

        It needs to be reviewed again on 14 March 2025
        by the page owner <a href="https://mojdt.slack.com/messages/opg-webops-community">#opg-webops-community</a>
        .
    </div>

    <div class='page-expiry--expired'>
      This page was set to be reviewed before 14 March 2025
       by the page owner <a href="https://mojdt.slack.com/messages/opg-webops-community">#opg-webops-community</a>.
      This might mean the content is out of date.
    </div>
  </div>

          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/ministryofjustice/opg-technical-guidance/blob/main/source/documentation/adrs/adr-007.html.md.erb">View source</a></li>
                <li><a href="https://github.com/ministryofjustice/opg-technical-guidance/issues/new?body=Problem+with+%27ADR-007+Healthcheck+Definitions%27+%28https%3A%2F%2Fdocs.opg.service.justice.gov.uk%2Fdocumentation%2Fadrs%2Fadr-007.html%29&amp;labels=bug&amp;title=Re%3A+%27ADR-007+Healthcheck+Definitions%27">Report problem</a></li>
                <li><a href="https://github.com/ministryofjustice/opg-technical-guidance">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">


      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="../../javascripts/application.js"></script>
  </body>
</html>
